<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Evaluation - esd</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>Evaluation | esd</title> <meta name="generator" content="Jekyll v3.9.0" /> <meta property="og:title" content="Evaluation" /> <meta name="author" content="No One" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="ESD …" /> <meta property="og:description" content="ESD …" /> <link rel="canonical" href="http://localhost:4000/evaluate/" /> <meta property="og:url" content="http://localhost:4000/evaluate/" /> <meta property="og:site_name" content="esd" /> <script type="application/ld+json"> {"@type":"WebPage","headline":"Evaluation","url":"http://localhost:4000/evaluate/","author":{"@type":"Person","name":"No One"},"description":"ESD …","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="http://localhost:4000/" class="site-title lh-tight"> esd </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="http://localhost:4000/" class="nav-list-link">esd R tool</a></li><li class="nav-list-item"><a href="http://localhost:4000/about/" class="nav-list-link">Background</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/functions/" class="nav-list-link">Utilities</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/_pages/retrieve/" class="nav-list-link">Retrieve</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/process/" class="nav-list-link">Processing I/O</a><ul class="nav-list "></ul></li><li class="nav-list-item"><a href="http://localhost:4000/analyses/" class="nav-list-link">Analyses I/O</a></li><li class="nav-list-item"><a href="http://localhost:4000/downscale/" class="nav-list-link">Downscaling</a></li><li class="nav-list-item active"><a href="http://localhost:4000/evaluate/" class="nav-list-link active">Evaluation</a></li><li class="nav-list-item"><a href="http://localhost:4000/%5Ctrouble%5C" class="nav-list-link">Trouble Shooting</a></li><li class="nav-list-item"><a href="http://localhost:4000/examples/" class="nav-list-link">Examples</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search esd" aria-label="Search esd" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="//github.com/metno/esd" class="site-button" > esd on GitHub </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <div id="main-content" class="main-content" role="main"> <h1 class="no_toc" id="evaluation-assessment--validation"> <a href="#evaluation-assessment--validation" class="anchor-heading" aria-labelledby="evaluation-assessment--validation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Evaluation, assessment &amp; validation </h1> <details open=""> <summary class="text-delta"> Table of contents </summary> <ol id="markdown-toc"> <li><a href="#central-limit-theorem" id="markdown-toc-central-limit-theorem">Central limit theorem</a></li> <li><a href="#huths-dilemma" id="markdown-toc-huths-dilemma">Huth’s dilemma</a></li> <li><a href="#non-stationarity-check" id="markdown-toc-non-stationarity-check">Non-stationarity check</a></li> <li><a href="#diagnose" id="markdown-toc-diagnose">Diagnose</a> <ol> <li><a href="#station" id="markdown-toc-station">Station</a></li> <li><a href="#combined-fields" id="markdown-toc-combined-fields">Combined fields</a></li> <li><a href="#common-eofs" id="markdown-toc-common-eofs">Common EOFs</a></li> </ol> </li> <li><a href="#downscaled-results" id="markdown-toc-downscaled-results">Downscaled results</a> <ol> <li><a href="#cross-validation" id="markdown-toc-cross-validation">Cross-validation</a></li> <li><a href="#residuals" id="markdown-toc-residuals">Residuals</a></li> <li><a href="#downscaled-ensemble-results" id="markdown-toc-downscaled-ensemble-results">Downscaled ensemble results</a></li> </ol> </li> </ol> </details> <h2 id="central-limit-theorem"> <a href="#central-limit-theorem" class="anchor-heading" aria-labelledby="central-limit-theorem"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Central limit theorem </h2> <p>The central limit theorem states that the distribution of the sum or average of a large number of independent, identically distributed variables (iid) will be approximately normal, regardless of the underlying distribution. (src. http://www.math.uah.edu/stat/sample/CLT.html)</p> <h2 id="huths-dilemma"> <a href="#huths-dilemma" class="anchor-heading" aria-labelledby="huths-dilemma"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Huth’s dilemma </h2> <p>Huth’s dilemma is the situation where ESD is calibrated on short-term (fast) fluctuation but is not capable of predicting long-term (slow) changes. This is a problem if there are different processes responsible for variations at different time scales. One test to provide a diagnose on whether this is the case is to calibrate the model on de-trended data and then use the original field as input to see if it is able to predict the long-term trend over the calibration period. In ‘esd’, the default process de-trends the data before calibration. The downscaled results are derived with the original field, however, and trends are compared against the original ob- servations. Furthermore, the question of stationary signal should be examined in the context of climate model results, and the past changes seen in the observations should be compared with corresponding downscaled results from GCM historic runs. Ensembles of GCMs are particularly suitable for assessing the ESD model’s ability to capture the long-term changes.</p> <h2 id="non-stationarity-check"> <a href="#non-stationarity-check" class="anchor-heading" aria-labelledby="non-stationarity-check"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Non-stationarity check </h2> <p>The non-stationarity check in ‘esd’ treats the GCM results as pseudo-reality, where results interpolated to the coordinates as a given station is used as the predictand. The same time interval as the reanalysis data used for calibrating the model is extracted from the GCM for representing the calibration predictors. The model trained on the subset of GCM results is then used to predict future values for the predictand, and the predictions from the downscaling of the pseudo-reality are compared with corresponding results derived by the interpolation. The downscaled pseudo-reality can also be compared with the results downscaled for the actual station data. This is done in ‘DSensemble’ when the argument ‘non.stationarity.check’ is set to ‘TRUE’.</p> <p>###iid.test The iid.test included in the esd package is used to test whether a variable is independent and identically distributed (iid) mainly for daily station records (Benestad , 2003, 2004). It has to be noted that this test is sensitive to missing data (NA) and can produce an under-count. A non i.i.d. behaviour appears when the ’forward’ (resp. ’backward’) analysis indicates higher (resp. lower) number of record-events than the confidence interval.</p> <h2 id="diagnose"> <a href="#diagnose" class="anchor-heading" aria-labelledby="diagnose"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Diagnose </h2> <p>The ‘diagnose’ method provides a range of different approaches for the evaluation of ’esd’ results depending on the type of objects. For instance, it returns diagnostics of common EOFs or cross-validation of DS results. The diagnostic also includes combined fields, MVR, and CCA results by applying appropriate internal tests to check for consistency. For instance, when applied to a combined ‘eof’ object, ‘diagnose’ investigates the difference in the mean between the PCs of the calibration data and the PCs of the GCMs over a common period in addition to the ratio of standard deviations and lag-one auto-correlation. A bias correction method can then be applied if the difference is significant as described in (Imbert and Benestad , 2005). Figure 26: The results of ‘diagnose’ applied to four different data objects: (a) common field, (b) to common EOFs, (c) downscaled results for an ensemble, and (d) a station.</p> <h3 id="station"> <a href="#station" class="anchor-heading" aria-labelledby="station"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Station </h3> <p>The ‘diagnose’ for station object offers another way of plotting the information contents and is designed for a group of stations to indicate the availability of valid data (Example 6.1, Figure 26d).</p> <h3 id="combined-fields"> <a href="#combined-fields" class="anchor-heading" aria-labelledby="combined-fields"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Combined fields </h3> <p>The application of ‘diagnose’ to a combined pair of field objects will produce two comparable curves that show their spatial mean values (Example 6.2, Figure 26a). This way, the spatial statistics of the two fields can be compared.</p> <h3 id="common-eofs"> <a href="#common-eofs" class="anchor-heading" aria-labelledby="common-eofs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Common EOFs </h3> <p>For common EOFs, ‘diagnose’ returns a set of different diagnostics, such as mean differences, the standard deviation ratio, and different auto-correlation for the principal components over an overlapping interval (6.3).</p> <p>Example 6.1.</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Retrieve NACD data sets</span><span class="w">
</span><span class="n">nacd</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">station</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="err">’</span><span class="n">nacd</span><span class="err">’</span><span class="p">)</span><span class="w">
</span><span class="c1"># Diagnose for data availability</span><span class="w">
</span><span class="n">diagnose</span><span class="p">(</span><span class="n">nacd</span><span class="p">)</span><span class="w">
</span><span class="n">Example</span><span class="w"> </span><span class="m">6.2</span><span class="n">.</span><span class="w">
</span><span class="c1"># Sample 2m air temperature ERAINT field from EOF’s data</span><span class="w">
</span><span class="n">t2m</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">t2m.ERAINT</span><span class="p">(</span><span class="n">lon</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">-30</span><span class="p">,</span><span class="m">40</span><span class="p">),</span><span class="n">lat</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">50</span><span class="p">,</span><span class="m">70</span><span class="p">))</span><span class="w">
</span><span class="c1"># Retrieve GCM air temperature from file</span><span class="w">
</span><span class="c1"># Sample 2m air temperature NorESM field from EOF’s data</span><span class="w">
</span><span class="n">gcm</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">t2m.NorESM.M</span><span class="p">()</span><span class="w">
</span><span class="c1"># Combine annual fields</span><span class="w">
</span><span class="n">X</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">combine</span><span class="p">(</span><span class="n">annual</span><span class="p">(</span><span class="n">t2m</span><span class="p">),</span><span class="n">annual</span><span class="p">(</span><span class="n">gcm</span><span class="p">))</span><span class="w">
</span><span class="c1"># Diagnose the result</span><span class="w">
</span><span class="n">diagnose</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="w">
</span><span class="n">Example</span><span class="w"> </span><span class="m">6.3</span><span class="n">.</span><span class="w">
</span><span class="c1"># Compute EOF, X is taken from previous example</span><span class="w">
</span><span class="n">eof</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">EOF</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="w">
</span><span class="c1"># Diagnose eof</span><span class="w">
</span><span class="n">a</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">diagnose</span><span class="p">(</span><span class="n">eof</span><span class="p">)</span><span class="w">
</span><span class="c1"># Plot the results</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <h2 id="downscaled-results"> <a href="#downscaled-results" class="anchor-heading" aria-labelledby="downscaled-results"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Downscaled results </h2> <p>The quality of the downscaled results can be investigated and checked with the function <code class="language-plaintext highlighter-rouge">diagnose.ds</code> (Example 6.4). In addition cross-validation and residuals can be used to evaluate the downscaling procedure.</p> <h3 id="cross-validation"> <a href="#cross-validation" class="anchor-heading" aria-labelledby="cross-validation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Cross-validation </h3> <p>A default option is to perform a five-fold cross-validation test (’crossval’)), but it can also be set to perform the CORDEX-ESD experiment 1 or VALUE experiment 1 set-up. The results of the cross-validation consist of a zoo-object that is stored in the attribute ‘attr(*,’evaluation’).</p> <h3 id="residuals"> <a href="#residuals" class="anchor-heading" aria-labelledby="residuals"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Residuals </h3> <p>The residuals of the downscaling should ideally be a white noise that has no auto-correlation, no trend, and is normally distributed. These conditions can be tested using auto-correlation functions and time series and qqnorm plots.</p> <h3 id="downscaled-ensemble-results"> <a href="#downscaled-ensemble-results" class="anchor-heading" aria-labelledby="downscaled-ensemble-results"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Downscaled ensemble results </h3> <p>For ensembles ‘diagnose’ shows a comparison between DS results derived from GCMs and the past variations. It compares the number of observed values outside the predicted 90% confidence interval based on fitting a normal distribution to the ensemble member values for each year, in addition to carrying out an evaluation of trends based on the rank the observed trend has compared to corresponding trends simulated by the ensemble for the past. The diagnostics produces an info-graphic in the form of a target (Example 6.5, Fig 26d). The count of the cases where observations fall outside the 90% confidence interval is expected to follow a binomial distribution if the model results reproduce the correct statistics (H0). Hence, p = 0.1 for falling outside, and the test is to see if the actual count of cases outside the confidence interval is consistent with the H0 binomial distribution (Benestad and Mezghani , 2015).</p> <p>Example 6.4. # Load temperature data for Oslo</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data</span><span class="p">(</span><span class="n">Oslo</span><span class="p">)</span><span class="w">
</span><span class="c1"># Get the 2m air temperature from NCEP reanalysis</span><span class="w">
</span><span class="n">t2m</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">t2m.NCEP</span><span class="p">(</span><span class="n">lon</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">-5</span><span class="p">,</span><span class="m">20</span><span class="p">),</span><span class="n">lat</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">50</span><span class="p">,</span><span class="m">65</span><span class="p">))</span><span class="w">
</span><span class="c1"># Compute the EOF on annual temperature values</span><span class="w">
</span><span class="n">eof</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">EOF</span><span class="p">(</span><span class="n">annual</span><span class="p">(</span><span class="n">t2m</span><span class="p">))</span><span class="w">
</span><span class="c1"># Downscale the annual values</span><span class="w">
</span><span class="n">z</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">DS</span><span class="p">(</span><span class="n">annual</span><span class="p">(</span><span class="n">Oslo</span><span class="p">),</span><span class="n">eof</span><span class="p">)</span><span class="w">
</span><span class="c1"># Do the diagnostic</span><span class="w">
</span><span class="n">diagnose</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">plot</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span><span class="n">Example</span><span class="w"> </span><span class="m">6.5</span><span class="n">.</span><span class="w"> </span><span class="c1"># Download the file from the figshare link as</span><span class="w">
</span><span class="n">download.file</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">"http://files.figshare.com/2081407/dse.oslo.rda"</span><span class="p">,</span><span class="n">destfile</span><span class="o">=</span><span class="s2">"dseOslo.rda"</span><span class="p">)</span><span class="w">
</span><span class="c1"># Load the file into R session</span><span class="w">
</span><span class="n">load</span><span class="p">(</span><span class="err">’</span><span class="n">dseOslo.rda</span><span class="err">’</span><span class="p">)</span><span class="w">
</span><span class="c1"># Do the diagnostic</span><span class="w">
</span><span class="n">diagnose</span><span class="p">(</span><span class="n">dse.oslo</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
