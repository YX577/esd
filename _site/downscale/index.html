<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Downscaling - esd</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>Downscaling | esd</title> <meta name="generator" content="Jekyll v3.9.0" /> <meta property="og:title" content="Downscaling" /> <meta name="author" content="No One" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="ESD …" /> <meta property="og:description" content="ESD …" /> <link rel="canonical" href="http://localhost:4000/downscale/" /> <meta property="og:url" content="http://localhost:4000/downscale/" /> <meta property="og:site_name" content="esd" /> <script type="application/ld+json"> {"@type":"WebPage","headline":"Downscaling","url":"http://localhost:4000/downscale/","author":{"@type":"Person","name":"No One"},"description":"ESD …","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="http://localhost:4000/" class="site-title lh-tight"> esd </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="http://localhost:4000/" class="nav-list-link">esd R tool</a></li><li class="nav-list-item"><a href="http://localhost:4000/about/" class="nav-list-link">Background</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/functions/" class="nav-list-link">Utilities</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/_pages/retrieve/" class="nav-list-link">Retrieve</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/process/" class="nav-list-link">Processing I/O</a><ul class="nav-list "></ul></li><li class="nav-list-item"><a href="http://localhost:4000/analyses/" class="nav-list-link">Analyses I/O</a></li><li class="nav-list-item active"><a href="http://localhost:4000/downscale/" class="nav-list-link active">Downscaling</a></li><li class="nav-list-item"><a href="http://localhost:4000/evaluate/" class="nav-list-link">Evaluation</a></li><li class="nav-list-item"><a href="http://localhost:4000/%5Ctrouble%5C" class="nav-list-link">Trouble Shooting</a></li><li class="nav-list-item"><a href="http://localhost:4000/examples/" class="nav-list-link">Examples</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search esd" aria-label="Search esd" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="//github.com/metno/esd" class="site-button" > esd on GitHub </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <div id="main-content" class="main-content" role="main"> <h1 class="no_toc" id="downscaling"> <a href="#downscaling" class="anchor-heading" aria-labelledby="downscaling"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Downscaling </h1> <p>Downscaling tries to identify (statistical) existing relationships between large-scale spatial climate patterns (called predictors) and local climate variations (predictands) in climate variables, parameters, and/or indicators (indices).</p> <details open=""> <summary class="text-delta"> Table of contents </summary> <ol id="markdown-toc"> <li><a href="#defining-predictands" id="markdown-toc-defining-predictands">Defining predictands</a></li> <li><a href="#defining-predictors" id="markdown-toc-defining-predictors">Defining predictors</a> <ol> <li><a href="#tuning" id="markdown-toc-tuning">Tuning</a></li> </ol> </li> <li><a href="#options-for-downscaling" id="markdown-toc-options-for-downscaling">Options for downscaling</a> <ol> <li><a href="#downscaling-for-single-station-and-a-single-model" id="markdown-toc-downscaling-for-single-station-and-a-single-model">Downscaling for single station and a single model</a></li> <li><a href="#downscaling-a-group-of-stations---pca" id="markdown-toc-downscaling-a-group-of-stations---pca">Downscaling a group of stations - PCA</a></li> <li><a href="#downscaling-an-ensemble-of-climate-models" id="markdown-toc-downscaling-an-ensemble-of-climate-models">Downscaling an ensemble of climate models</a></li> </ol> </li> <li><a href="#downscaling-of-trajectory-objects" id="markdown-toc-downscaling-of-trajectory-objects">Downscaling of trajectory objects</a></li> <li><a href="#downscaling-probabilities-and-number-of-events" id="markdown-toc-downscaling-probabilities-and-number-of-events">Downscaling probabilities and number of events</a></li> <li><a href="#weather-generators---synthesising-daily-time-series" id="markdown-toc-weather-generators---synthesising-daily-time-series">Weather generators - synthesising daily time series</a> <ol> <li><a href="#stochastic-precipitation" id="markdown-toc-stochastic-precipitation">Stochastic precipitation</a></li> <li><a href="#stochastic-temperature" id="markdown-toc-stochastic-temperature">Stochastic temperature</a></li> </ol> </li> </ol> </details> <h2 id="defining-predictands"> <a href="#defining-predictands" class="anchor-heading" aria-labelledby="defining-predictands"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Defining predictands </h2> <p>In downscaling based on ‘esd’, the predictand can be a station data (‘station’ class), a groups of stations (‘pca’), gridded data (‘eof’), or trajectory statistics. The strategy differs from that of ‘clim.pact’ by downscaling seasonal or annual mean statistics, rather than monthly and daily. The reason for this is the idea that there is a stronger connection between local and large-scale climate than between local and large-scale weather. Here ‘climate’ is defined as weather statistics and involves parameters derived from a sample of some variable, e.g. the mean or frequency over a season or a year. It follows that statistics such as the mean is estimated more accurately with larger sample sizes according to the central limit theorem, reducing the effect of both sampling fluctuations and random errors. Furthermore, according to the central limit theorem, the mean converges to being normally distributed with increasing sample size. The seasonal and annual scales also imply more data points, especially for precipitation - it doesn’t rain every day, and a monthly estimate may typically involve about 10 rain events - or 10 data points. One motivation for using PCA to represent the predictand is that it brings forth the coherent variations and the signal in the data that is expected to have the strongest connection with the large scales (Benestad et al., 2015). Furthermore, the use of PCA takes care of spatial cross correlation among the different stations. The downscaling model only considers variability - the mean level is prescribed based on the observations and a given reference period. Hence, it is not affected by biases in the mean (a form for systematic errors). The climatology of the end-result is set by the climatology of the observations (base period) and the downscaled results describe the deviation from this climatology. The downscaling uses common EOFs (Barnett, 1999) as a basis to ensure that the covariates used in the regression represent the exact same spatial structures (modes) when calibrating the regression model against reanalysis and when using the model to make predictions based on GCM results. The use of common EOFs is described in Benestad (2001).</p> <h2 id="defining-predictors"> <a href="#defining-predictors" class="anchor-heading" aria-labelledby="defining-predictors"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Defining predictors </h2> <p>The large-scale predictors are represented in terms of EOFs and common EOFs in ‘esd’, where a regression analysis is used to estimate best-fit weights (regression coefficients βi) whose products with the PCs (ˆy(t) = Pn β i=1 iVi(t)) give the closest representation of the original time series y. n X ˆ y(t) = β0 + βiVi(t) (3) i=1 The term ‘covariate’ will henceforth be used to refer to the time-dependent variables on the right hand side of the multiple regression equation (Vi(t)). The default is that the regression is based on ordinary linear model, but there is an option in the argument ‘method’ to use generalised linear models or any other method that produces results with similar structure. The downscaling will also involve a forward-backward stepping, removing the PCs that do not increase the skill. The downscaling can combine several predictors of different types by using a list object as the predictor argument, containing the EOFs describing the different sets of predictors. In Example 5.1, a combination of the T(2m) and SLP are used as predictors for downscaling. The EOFs contained in the list are combined to a single ‘eof’ class, and then subject to the default downscaling as if the predictor represented one single variable. The combination of the predictors involves a weighting of each principal component according to its eigenvalue, and then a singular value decomposition (Strang, 1988; Press et al., 1989b) is used to distill the most pronounced and common variability embedded in the different data sets, in a similar way ‘mixed’ EOFs were used in Benestad et al. (2002) (or ‘mixed’ EOFs in ‘clim.pact’), described as ‘CPCA’ in Bretherton et al. (1992). Sets of several different types of predictors are combined in terms of their principal components (PC) according to the following strategy: the PCs for each set are weighted by a set of normalised weights to ensure that each type of predictor carry similar weight in addition to giving more weight to the leading EOFs that explain more of the variance (For each respective EOF, P w i i = 1). The weighted PCs are then combined and a singular value decomposition (SVD) is used to extract the common variability within the chosen predictors, and then the 20 leading modes are used to synthesise a data object that resembles the EOF object. This synthesised matrix is then used as a predictor that describes the most pronounced common/combined variability of the chosen predictor types.</p> <h3 id="tuning"> <a href="#tuning" class="anchor-heading" aria-labelledby="tuning"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Tuning </h3> <p>The downscaling can be tuned after the set of predictors is chosen. The predictor domain is by default set to a fixed spatial window (width to be specified by the user), but different choices for the domain will affect the results (Benestad , 2001). Also the number of EOFs included will affect the outcome, and the default is set to include the 7 leading modes. The number of EOFs can be determined manually as the first components with the maximum of variability (This can be achieved by looking at ‘plot(eof)’).</p> <h2 id="options-for-downscaling"> <a href="#options-for-downscaling" class="anchor-heading" aria-labelledby="options-for-downscaling"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Options for downscaling </h2> <p>There are several downscaling approaches depending on the temporal resolution and the final objective of the impact study i.e. one can perform a DS for each year, season or month then combine the 12 months. For instance, annual downscaling is based on a new strategy which means extract annual statistics from daily or monthly data and do the downscaling.</p> <h3 id="downscaling-for-single-station-and-a-single-model"> <a href="#downscaling-for-single-station-and-a-single-model" class="anchor-heading" aria-labelledby="downscaling-for-single-station-and-a-single-model"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Downscaling for single station and a single model </h3> <p>The basic downscaling is done for a single predictand (station) and a single predictor (EOF), and there are various ‘wrappers’ that use this elementary part as pieces of a more complicated process. The predictor can be a common EOF, constructed using ‘combine’ on two fields and then an estimation of the EOFs. The downscaling can also be applied to a group of stations or gridded fields.</p> <h3 id="downscaling-a-group-of-stations---pca"> <a href="#downscaling-a-group-of-stations---pca" class="anchor-heading" aria-labelledby="downscaling-a-group-of-stations---pca"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Downscaling a group of stations - PCA </h3> <p>One benefit of downscaling ’PCA’ objects (using ‘DS.pca’ built-in function) rather than downscaling each single station separately is that the PCA-based analysis places more emphasis on the common signal found in adjacent stations and takes care about any strong spatial pattern that could be found in nearby stations. In other words, it may enhance the signal-to-noise ratio by separating out the signal (leading PCAs) from the noise (high-level PCAs). Another aspect is that the downscaling takes into account the spatial correlation structure, embedded in the PCA where eachmode is orthogonal (Benestad et al., 2015).</p> <p>Example 5.2 and Figure 23 give a demonstration and a test of the downscaling of PCA.</p> <h3 id="downscaling-an-ensemble-of-climate-models"> <a href="#downscaling-an-ensemble-of-climate-models" class="anchor-heading" aria-labelledby="downscaling-an-ensemble-of-climate-models"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Downscaling an ensemble of climate models </h3> <p>The method ‘DSensemble’ is designed to deal with downscaling an ensemble of global or regional climate models such as CMIP3 and CMIP5 runs. The function ‘DSensemble’ reads all data specified in a common folder (specified in the input arguments) to do the downscaling, and each result is saved separately for each climate model. Each file in the climate models’ folder must be unique and must correspond to one climate model output stored in a NetCDF format. The GCM or RCM files should not be stored in several files spanning, for instance, different time slices. In this case, the files have to be concatenated before applying ‘DSensemble’. ‘DSensemble’ has also been extended to deal with a group of stations’ object (‘pca’), with a speed-up and benefits associated with PCA. The design of the ‘DSensemble’ methods tries to meet some of the criticism that Estrada et al. (2013) presented against ESD that are summarised in the following issues.</p> <ul> <li>a. The underlying probabilistic model assumed by an ESD method does not reflect the distribution of the underlying data.</li> <li>b. The method requires the variables to be stationary.</li> <li>c. ESD focuses on the short-term variability (Huth’s dilemma).</li> <li>d. Estimated relations of trend and/or auto-correlated series are at risk of being spurious.</li> <li>e. Statistical downscaling is an empirical method and the statistical adequacy should be evaluated using appropriate tools.</li> <li>f. Downscaling tool boxes seldom give any information regarding the significance of the estimated coefficients.</li> </ul> <p>The downscaling is applied to samples of data aiming at predicting parameters describing the sample distribution. For temperature, the sample size is N ≈90 data points (seasonal aggregates) whereas for precipitation, the downscaling is applied to annual aggregates because it doesn’t rain every day (typical size N ≈100). The idea is to downscale climate (defined as weather statistics) rather than weather, hence calibrating the models on aggregated parameters rather than day-to-day situations (issue ’c’). Furthermore, the primary parameters are the seasonal means for temperature and annual wet-day means and frequency for precipitation. According to the central limit theorem, the distribution of mean estimates is expected to converge to being normal with sample size (Wheelan, 2013). Hence, the default method (‘lm’) is appropriate for such parameters (issue ’a’), although other methods such as GLM may be used for other types of distributions. The usual requirement for ESD is that the transfer coefficients describing the link between the large and small scales are stationary, and not the variables themselves. Climate change by definition implies non-stationary variables, such a trend in temperature. In both esd and clim.pact the default is to de-trend the data before model calibration, in order to reduce the risk of spurious results (issues ‘b’ &amp; ‘d’). The auto-correlation between successive winters (or any other season) or years is low and forecasts for local temperature and precipitation aggregated for a year ahead is notoriously difficult as a result, which implies that auto-correlation has little effect on the outcome of the downscaled results in the default setting (issue ‘d’). When it comes to model evaluation tools (issue ‘e’), the method ’DS’, on which ‘DSensemble’ is based, uses cross-validation by default for assessing its skill. The R-environment also offers a set of tools for testing whether the data used for model calibration are normally distributed: e.g. ’qqnorm’. A Shapiro-Wilk test of normality is also included in ’diagnose.ds’ . Furthermore, ’DS’ invokes a step-wise screening that removes the predictors which do not make a statistical significant contribution to the regression (issue ‘f’), and esd includes a function that carries out an iid-test which can be applied to de-trended series: ‘iid.test’ (Benestad , 2008).</p> <h2 id="downscaling-of-trajectory-objects"> <a href="#downscaling-of-trajectory-objects" class="anchor-heading" aria-labelledby="downscaling-of-trajectory-objects"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Downscaling of trajectory objects </h2> <p>The function ‘DS’ can be applied to trajectory objects, but it is not the paths themselves that are downscaled but rather some statistical measure of each trajectory (Example 5.4, Figure 25). By default, the downscaling is applied to the monthly trajectory count. Trajectory objects may also be downscaled with regards to other aspects by adding a parameter name (‘param’) and a function to apply to the parameter for each path (‘FUN’). For example, we can calculate and downscale the genesis latitude (param=’lat’, FUN=’first’) or the mean longitude (param=’lon’,FUN=’mean’).</p> <p>Example 5.1.</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Load eofs of NCEP 2m air temperature</span><span class="w">
</span><span class="n">data</span><span class="p">(</span><span class="n">eof.t2m.NCEP</span><span class="p">)</span><span class="w">
</span><span class="c1"># Load eofs of NCEP sea level pressure</span><span class="w">
</span><span class="n">data</span><span class="p">(</span><span class="n">eof.slp.NCEP</span><span class="p">)</span><span class="w">
</span><span class="c1"># Load temperature data for Oslo</span><span class="w">
</span><span class="n">data</span><span class="p">(</span><span class="n">Oslo</span><span class="p">)</span><span class="w">
</span><span class="c1"># Do the downscaling</span><span class="w">
</span><span class="n">z</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">DS</span><span class="p">(</span><span class="n">Oslo</span><span class="p">,</span><span class="nf">list</span><span class="p">(</span><span class="n">t2m</span><span class="o">=</span><span class="n">eof.t2m.NCEP</span><span class="p">,</span><span class="n">slp</span><span class="o">=</span><span class="n">eof.slp.NCEP</span><span class="p">),</span><span class="n">mon</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w">
</span><span class="c1"># Plot the results</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <p>Figure 22: An example of downscaled annual mean temperature in Oslo, based on the ERAINT reanalysis and using PCA for downscaling a group of stations simultaneously.</p> <p>Example 5.2.</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Load ERAINT 2m air temperature from file</span><span class="w">
</span><span class="n">T2m</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">t2m.ERAINT</span><span class="p">(</span><span class="n">lon</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">-10</span><span class="p">,</span><span class="m">30</span><span class="p">),</span><span class="n">lat</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">50</span><span class="p">,</span><span class="m">70</span><span class="p">))</span><span class="w">
</span><span class="c1"># Compute the EOFs on annual values</span><span class="w">
</span><span class="n">eof</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">EOF</span><span class="p">(</span><span class="n">annual</span><span class="p">(</span><span class="n">T2m</span><span class="p">))</span><span class="w">
</span><span class="c1"># Retrieve Nordklim data sets</span><span class="w">
</span><span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">station</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="err">’</span><span class="n">nordklim</span><span class="err">’</span><span class="p">)</span><span class="w">
</span><span class="c1"># Get rid of stations with little valid data</span><span class="w">
</span><span class="n">Y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">allgood</span><span class="p">(</span><span class="n">annual</span><span class="p">(</span><span class="n">y</span><span class="p">))</span><span class="w">
</span><span class="c1"># Do the PCA</span><span class="w">
</span><span class="n">pca</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">PCA</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span><span class="w">
</span><span class="c1"># DO the downscaling</span><span class="w">
</span><span class="n">z</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">DS</span><span class="p">(</span><span class="n">pca</span><span class="p">,</span><span class="n">eof</span><span class="p">)</span><span class="w">
</span><span class="c1"># Plot the result</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="w">
</span><span class="c1"># Get the observations corresponding to the first station in the list</span><span class="w">
</span><span class="n">obs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span><span class="n">is</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w">
</span><span class="c1"># Get the predictions</span><span class="w">
</span><span class="n">pre</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">as.station</span><span class="p">(</span><span class="n">z</span><span class="p">),</span><span class="n">is</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w">
</span><span class="c1"># Match dates between obs and pre</span><span class="w">
</span><span class="n">obs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">matchdate</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span><span class="n">pre</span><span class="p">)</span><span class="w">
</span><span class="c1"># Update the attributes</span><span class="w">
</span><span class="nf">attr</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span><span class="err">’</span><span class="n">location</span><span class="err">’</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="err">’</span><span class="n">Observed</span><span class="err">’</span><span class="w">
</span><span class="nf">attr</span><span class="p">(</span><span class="n">pre</span><span class="p">,</span><span class="err">’</span><span class="n">location</span><span class="err">’</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="err">’</span><span class="n">Predicted</span><span class="err">’</span><span class="w">
</span><span class="c1"># Combine the two</span><span class="w">
</span><span class="n">obspre</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">combine.stations</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span><span class="n">pre</span><span class="p">)</span><span class="w">
</span><span class="c1"># Plot the result in a single plot</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">obspre</span><span class="p">,</span><span class="n">plot.type</span><span class="o">=</span><span class="s2">"single"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <p>Figure 23: An example of downscaled annual mean temperature in Oslo, based on the ERAINT reanalysis and using PCA for downscaling a group of stations simultaneously.</p> <p>Example 5.3.</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Get the predictand: Maximum temperature for some Norwegian sttions</span><span class="w">
</span><span class="n">download.file</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">"http://files.figshare.com/2073466/Norway.Tx.rda"</span><span class="p">,</span><span class="n">destfile</span><span class="o">=</span><span class="s2">"NorwayTx.rda"</span><span class="p">)</span><span class="w">
</span><span class="n">load</span><span class="p">(</span><span class="s2">"NorwayTx.rda"</span><span class="p">)</span><span class="w">
</span><span class="c1"># Process the predictand (annual mean)</span><span class="w">
</span><span class="n">ma</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">annual</span><span class="p">(</span><span class="n">Tx</span><span class="p">)</span><span class="w">
</span><span class="n">pca</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">PCA</span><span class="p">(</span><span class="n">ma</span><span class="p">)</span><span class="w">
</span><span class="c1"># Get the ERAINT T(2m):</span><span class="w">
</span><span class="n">t2m</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">t2m.ERAINT</span><span class="p">(</span><span class="n">lon</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">-30</span><span class="p">,</span><span class="m">30</span><span class="p">),</span><span class="n">lat</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">50</span><span class="p">,</span><span class="m">75</span><span class="p">))</span><span class="w">
</span><span class="c1"># Process the predictor: Compute EOFs of annual means</span><span class="w">
</span><span class="n">eof</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">EOF</span><span class="p">(</span><span class="n">annual</span><span class="p">(</span><span class="n">X</span><span class="p">))</span><span class="w">
</span><span class="c1"># Test: CCA:</span><span class="w">
</span><span class="n">cca</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">CCA</span><span class="p">(</span><span class="n">pca</span><span class="p">,</span><span class="n">eof</span><span class="p">)</span><span class="w">
</span><span class="c1"># Do the downscaling</span><span class="w">
</span><span class="n">z</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">DS</span><span class="p">(</span><span class="n">pca</span><span class="p">,</span><span class="n">eof</span><span class="p">,</span><span class="n">rmtrend</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span><span class="c1"># Plot the results for one station:</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">subset</span><span class="p">(</span><span class="n">ma</span><span class="p">,</span><span class="n">is</span><span class="o">=</span><span class="m">1</span><span class="p">))</span><span class="w">
</span><span class="n">lines</span><span class="p">(</span><span class="n">subset</span><span class="p">(</span><span class="n">as.station</span><span class="p">(</span><span class="n">pca</span><span class="p">),</span><span class="n">is</span><span class="o">=</span><span class="n">is</span><span class="p">),</span><span class="n">lty</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s2">"darkred"</span><span class="p">)</span><span class="w">
</span><span class="n">lines</span><span class="p">(</span><span class="n">subset</span><span class="p">(</span><span class="n">as.station</span><span class="p">(</span><span class="n">z</span><span class="p">),</span><span class="n">is</span><span class="o">=</span><span class="n">is</span><span class="p">),</span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <p>Figure 24: An example of downscaled CMIP5 RCP8.5 DJF seasonal mean temperature eastern Norway. The ERA40 reanalysis is used here for calibration. The inner plot in the right bottom of the figure shows a comparison between the estimated linear trend from both simulations (in terms of distribution) and observations (black point). While, the inner plot on the top right of the figure shows the distribution of the number of observations lying outside the 90% of the confidence interval based on simulations.</p> <p>Example 5.4.</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Load storm trajectories</span><span class="w">
</span><span class="n">data</span><span class="p">(</span><span class="n">imilast.M03</span><span class="p">)</span><span class="w">
</span><span class="c1"># Load NCEP sea level pressure data for the northern hemisphere</span><span class="w">
</span><span class="n">slp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">slp.NCEP</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">90</span><span class="p">))</span><span class="w">
</span><span class="c1"># Compute eof</span><span class="w">
</span><span class="n">eof.slp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">EOF</span><span class="p">(</span><span class="n">slp</span><span class="p">)</span><span class="w">
</span><span class="c1"># Do downscaling for the storm count</span><span class="w">
</span><span class="p">(</span><span class="n">default</span><span class="w"> </span><span class="n">trajectory</span><span class="w"> </span><span class="n">downscaling</span><span class="p">)</span><span class="w">
</span><span class="n">ds</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">DS</span><span class="p">(</span><span class="n">imilast.M03</span><span class="p">,</span><span class="n">eof.slp</span><span class="p">)</span><span class="w">
</span><span class="c1"># Do downscaling from slp</span><span class="w">
</span><span class="n">ds.slp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">DS</span><span class="p">(</span><span class="n">imilast.M03</span><span class="p">,</span><span class="n">eof.slp</span><span class="p">,</span><span class="n">param</span><span class="o">=</span><span class="err">’</span><span class="n">slp</span><span class="err">’</span><span class="p">,</span><span class="n">FUN</span><span class="o">=</span><span class="err">’</span><span class="n">min</span><span class="err">’</span><span class="p">,</span><span class="n">unit</span><span class="o">=</span><span class="err">’</span><span class="n">hPa</span><span class="err">’</span><span class="p">)</span><span class="w">
</span><span class="c1"># Plot downscaled results</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">ds.slp</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <p>Figure 25: Two examples of downscaling the storm tracks of the North Atlantic region with regards to the storm count (a) and minimum slp (b).</p> <h2 id="downscaling-probabilities-and-number-of-events"> <a href="#downscaling-probabilities-and-number-of-events" class="anchor-heading" aria-labelledby="downscaling-probabilities-and-number-of-events"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Downscaling probabilities and number of events </h2> <p>The original time series can be summarised as the probability distribution of a climate variable or parameter, the latter can then be downscaled instead of the original time series. For instance, the 24-hour wet-day precipitation amount is expected to follows an exponential or gamma distribution, whereas the temperature is more likely to follow a normal distribution, and the wind-speed a Weibull distribution. The count of events is expected to follow a binomial or Poisson distribution and spell-length statistics tends to have a geometric distribution. The predictands here are the parameters of the probability distribution function rather than the original climate variable. These are mainly the first order and second order moments such as the mean (for exponential distribution), the mean and the standard deviation for the normal distribution, and the mean and the coefficient of variation for the gamma distribution. Downscaling of µ, fw, and ncwd (wet spell length) require different choices in the type of regression model because they involve different types of data (Estrada et al., 2013). The set-up may involve continuous values, fractions (f ∈ [0, 1]), and discrete counts. sometimes it may be difficult to decide which category to use. For example, the annual wet-day frequency is a mean estimated over a set of zeros and ones and exhibits a character closer to normal than logistic distribution, but while each day would be subject to a logistic distribution, its annual mean is subject to the central limit theorem.</p> <h2 id="weather-generators---synthesising-daily-time-series"> <a href="#weather-generators---synthesising-daily-time-series" class="anchor-heading" aria-labelledby="weather-generators---synthesising-daily-time-series"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Weather generators - synthesising daily time series </h2> <p>Weather generators are usually used to simulate realistic sequences of daily weather and climate variables such as precipitation, maximum and minimum temperature for present (Semenov and Barrow , 1997; Wilks and Wilby, 1999) and future climate conditions (Wilks, 1992). Weather generators can be seen as complementary tools and are used in conjunction with downscaling techniques. They use (downscaled) parameters of the several distribution functions of climate variables. The generation process differs between climate parameters, variables and statistics. For precipitation, most weather generators will generate first dry and wet sequences, and then for the wet days, the precipitation amount is generated following different probability and using different random numbers form different distributions (Mezghani and Hingray, 2009). The simulation process takes into account the various specific aspects of climate variability and change (Soltani and Hoogenboom, 2003). The simulated sequences must share the main statistical properties of the observed or original time series used for calibration (Semenov and Brooks, 1999). The general form of a WG can be written as follows: \(Y = f (X, ǫ)\), (4) where $ǫ$ is an ensemble of random variables which contains the remaining information that has not been taken into account by X and the random processes that is involved.</p> <p>There are various ways a weather generator can be designed, and ’esd’ may include more types in the future. Presently, there are two different types, one for precipitation and one for temperature. These are designed so that they are conditioned upon downscaled results for seasonal of annual scales, using vital parameters to disaggregate the results to daily values. The results will span a similar time interval as the provided observations x but may be shifted in time if a set of projections is provided (taking an interval that ends on the last projected year).</p> <h3 id="stochastic-precipitation"> <a href="#stochastic-precipitation" class="anchor-heading" aria-labelledby="stochastic-precipitation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Stochastic precipitation </h3> <p>The stochastic or generation process for precipitation uses information about wet-day mean, frequency, and consecutive wet days to generate stochastic precipitation series. The call is ‘WG.fw.day.precip’ and its features are (roughly):</p> <ul> <li>Estimate wet-day mean and frequency as well as the wet- and dry-spell statistics for a station.</li> <li>Uses phase-scrambled Fourier transform of annual observed/downscaled wet-day mean and frequency.</li> <li>Estimate the number of wet days per year.</li> <li>Wet days: amounts prescribed according to the exponential distribution and µ.</li> <li>Try to distribute wet days according to both the number of wet days per year and with a wet-spell statistics according to annual mean number of consecutive wet days assuming a geometric distribution.</li> </ul> <h3 id="stochastic-temperature"> <a href="#stochastic-temperature" class="anchor-heading" aria-labelledby="stochastic-temperature"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Stochastic temperature </h3> <p>The weather generator for daily temperature is ‘WG.FT.day.t2m’, currently designed for single stations. The key features of this weather generator are (roughly):</p> <ul> <li>Uses phase-scrambled Fourier transform of observed or downscaled annual mean temperature anomaly to produce a random order of annual data.</li> <li>Uses phase-scrambled Fourier transform of observed or downscaled annual standard deviation of daily temperature anomalies to produce a random order of annual data.</li> <li>Uses quantile-quantile mapping to generate normally distributed stochastic variables conditioned on prescribed mean and standard deviation.</li> </ul> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
